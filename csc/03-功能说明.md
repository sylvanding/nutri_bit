# 福宝智能营养健康管理系统 - 功能说明

## 一、用户认证与账户管理

### 1.1 用户注册
**功能描述：**
系统支持多种注册方式，包括邮箱注册、手机号注册和第三方授权登录（微信、支付宝、Apple ID）。用户可根据个人习惯选择便捷的注册方式。

**主要功能点：**
- 邮箱注册：用户输入邮箱地址和密码，系统发送验证邮件，用户点击邮件链接完成验证
- 手机号注册：用户输入手机号，系统发送短信验证码，验证通过后设置密码完成注册
- 第三方登录：支持微信、支付宝、Apple ID等第三方平台授权登录，无需单独注册
- 密码强度检测：要求密码长度不少于8位，包含字母和数字，确保账户安全
- 用户协议与隐私政策：注册时需阅读并同意用户协议和隐私政策

**技术实现：**
- 前端表单验证：实时验证输入格式的合法性
- 后端接口：RESTful API接口处理注册请求
- 安全机制：密码使用bcrypt加密存储，验证码有效期5分钟
- 第三方授权：OAuth 2.0协议实现第三方授权登录
- 数据库存储：用户信息存储在PostgreSQL数据库users表

**界面截图位置：**
> [待补充：用户注册界面截图]

---

### 1.2 用户登录
**功能描述：**
已注册用户可通过邮箱/手机号+密码登录，或使用第三方账号快速登录。系统支持"记住我"功能和自动登录。

**主要功能点：**
- 邮箱/手机号登录：输入注册时使用的邮箱或手机号及密码登录
- 第三方快速登录：一键使用微信、支付宝、Apple ID登录
- 记住登录状态：勾选"记住我"，下次启动自动登录
- 找回密码：忘记密码时通过邮箱或手机号验证后重置密码
- 登录安全：支持登录设备管理，可查看和移除异常登录设备

**技术实现：**
- JWT Token认证：登录成功后颁发访问令牌（access token）和刷新令牌（refresh token）
- Token有效期：访问令牌有效期2小时，刷新令牌有效期30天
- 会话管理：Redis存储用户会话信息，支持快速验证和多端登录
- 安全防护：连续登录失败5次后锁定账户10分钟，防止暴力破解

**界面截图位置：**
> [待补充：用户登录界面截图]

---

### 1.3 健康档案创建
**功能描述：**
用户首次登录后需创建个人健康档案，系统根据档案信息计算个性化的营养需求和健康目标。

**主要功能点：**
- 基础信息采集：姓名、年龄、性别、身高、体重
- 活动水平选择：低强度（久坐）、中强度（定期运动）、高强度（高频运动/体力劳动）
- 健康目标设定：
  - 减脂：设置目标体重和预期时间
  - 增肌：设置目标体重和训练计划
  - 维持健康：保持当前状态
  - 特殊营养：选择营养关注点（低钠、高蛋白、低碳水、高纤维）
- 慢性病管理：支持选择多种慢性病（糖尿病、高血压、高血脂、痛风、心脏病、肾病、肝病、骨质疏松、甲状腺疾病、贫血、胃病等12种）
- 饮食偏好设置：饮食类型（普通、素食、纯素、生酮）、过敏食物、不喜欢的食物

**技术实现：**
- 营养需求计算算法：
  - 基础代谢率（BMR）计算：使用Harris-Benedict公式
    - 男性：BMR = 88.362 + (13.397 × 体重kg) + (4.799 × 身高cm) - (5.677 × 年龄)
    - 女性：BMR = 447.593 + (9.247 × 体重kg) + (3.098 × 身高cm) - (4.330 × 年龄)
  - 每日总热量需求（TDEE）= BMR × 活动系数
    - 低强度：1.2
    - 中强度：1.55
    - 高强度：1.9
  - 宏量营养素分配：
    - 减脂：蛋白质30%、碳水40%、脂肪30%
    - 增肌：蛋白质35%、碳水45%、脂肪20%
    - 维持：蛋白质25%、碳水50%、脂肪25%
- 慢性病适配：根据慢性病类型调整营养素建议（如糖尿病降低碳水比例、高血压降低钠摄入标准）
- 数据存储：健康档案存储在user_profiles表，支持随时修改更新

**界面截图位置：**
> [待补充：健康档案创建引导界面截图]
> [待补充：健康目标设置界面截图]
> [待补充：慢性病选择界面截图]

---

## 二、AI图像识别与营养记录

### 2.1 拍照识别功能
**功能描述：**
系统核心功能，用户通过拍照或上传图片，AI自动识别菜品名称、分析食材组成、估算营养成分。支持单菜品和复合菜品识别。

**主要功能点：**
- 拍照记录：启动相机拍摄当前餐食
- 相册上传：从相册选择已有照片识别
- 餐次选择：标记为早餐、午餐、晚餐或加餐
- AI识别：深度学习算法识别菜品
  - 单菜品识别：识别单一菜品如"宫保鸡丁"
  - 复合菜品识别：识别多菜品组合，如套餐、自助餐
  - 原料分解：将菜品分解为具体食材（如宫保鸡丁 = 鸡肉 + 花生 + 青椒 + 油盐糖等）
- 识别结果展示：显示识别出的菜品列表和初步营养数据
- 置信度显示：展示AI识别的置信度，低置信度菜品标注提醒
- 手动修正：支持修改、删除、添加菜品

**技术实现：**
- AI模型：基于深度学习的计算机视觉模型（VLM - Vision Language Model）
- 菜品数据库：10000+中式菜品库，包含菜品图片、名称、常用原料
- 食材数据库：5000+食材营养成分库，包含热量、蛋白质、碳水、脂肪、钠、纤维等数据
- 识别流程：
  1. 图片预处理：调整大小、增强对比度
  2. 特征提取：卷积神经网络提取图像特征
  3. 菜品匹配：与菜品数据库比对，输出Top 5候选
  4. 原料分解：查询菜品配方数据库，获取原料组成
  5. 营养汇总：累加各原料营养成分，得到总营养值
- 识别准确率：单菜品识别准确率 ≥ 85%
- 响应时间：≤ 3秒返回识别结果
- 会员权限：免费用户每月10次识别，会员/VIP无限次

**界面截图位置：**
> [待补充：拍照识别入口界面截图]
> [待补充：识别进行中加载界面截图]
> [待补充：识别结果展示界面截图]

---

### 2.2 智能微调系统
**功能描述：**
创新性的用户参与式营养估算功能。用户可根据实际情况调整场景、口味、份量，系统动态调整营养数据，提升估算准确性。

**主要功能点：**
- 场景选择：
  - 家常菜：较少油盐，营养相对健康
  - 餐厅/外卖：用油盐较多，热量脂肪增加20-30%
  - 食堂：标准化烹饪，营养适中
- 口味调整：
  - 清淡：油盐糖减少30%
  - 适中：标准用量
  - 重口味：油盐糖增加30-50%
- 份量估算：
  - 小份：约1拳大小，重量×0.7
  - 中份：约2拳大小，标准重量
  - 大份：约3拳或更多，重量×1.5
- 参照物对比：提供碗、盘子、手掌等可视化参照物
- 实时预览：调整参数后实时显示营养数据变化
- 保存偏好：系统记住用户的常用选择，下次自动应用

**技术实现：**
- 营养调整算法：
  - 基础营养值 × 场景系数 × 口味系数 × 份量系数 = 最终营养值
  - 场景系数：家常菜(1.0)、餐厅(1.25)、食堂(1.1)
  - 口味系数：清淡(0.7)、适中(1.0)、重口味(1.4)
  - 份量系数：小份(0.7)、中份(1.0)、大份(1.5)
- 用户偏好学习：记录用户每次调整，分析常用选项，下次优先推荐
- 数据优化闭环：收集用户调整数据，定期优化AI模型的初始估算
- 视觉辅助：提供不同份量的参照图片，帮助用户准确判断

**界面截图位置：**
> [待补充：智能微调界面截图-场景选择]
> [待补充：智能微调界面截图-口味调整]
> [待补充：智能微调界面截图-份量估算]

---

### 2.3 手动输入记录
**功能描述：**
为无法拍照或需要精确记录的场景提供手动输入功能。支持搜索菜品、自定义食材、快速录入常用食物。

**主要功能点：**
- 菜品搜索：输入菜品名称，从数据库搜索匹配菜品
- 常用食物：展示用户历史常吃的食物，一键添加
- 自定义食材：输入食材名称和重量，系统自动计算营养
- 营养素直接输入：高级用户可直接输入热量、蛋白质等数值
- 模板保存：保存常吃的组合为模板，如"我的早餐"
- 快速复制：复制历史记录的餐食到当前

**技术实现：**
- 搜索引擎：Elasticsearch全文搜索，支持模糊匹配和拼音搜索
- 食物库：10000+菜品 + 5000+食材，每条记录包含营养成分
- 数据关联：用户历史记录关联分析，智能推荐常用食物
- 输入验证：校验数值合理性，避免输入错误

**界面截图位置：**
> [待补充：手动输入界面截图]
> [待补充：菜品搜索界面截图]
> [待补充：自定义食材界面截图]

---

### 2.4 语音记录
**功能描述：**
通过语音输入快速记录餐食，系统自动识别菜品名称并添加到记录。适合开车、运动等不方便打字的场景。

**主要功能点：**
- 语音输入：长按说话，如"我刚吃了一碗牛肉拉面和一个煎蛋"
- 语音识别：将语音转换为文本
- 智能解析：从文本中提取菜品名称和数量
- 自动匹配：在数据库中匹配对应菜品
- 确认修改：用户确认识别结果，可手动调整

**技术实现：**
- 语音识别：调用语音识别API（如百度、讯飞、阿里云）
- 自然语言处理：NLP技术提取菜品实体和数量信息
- 实体识别：命名实体识别（NER）识别食物名称
- 数量提取：正则表达式和规则匹配提取数量词

**界面截图位置：**
> [待补充：语音输入界面截图]

---

### 2.5 条形码扫描
**功能描述：**
扫描包装食品条形码，自动获取食品营养信息，快速完成记录。

**主要功能点：**
- 扫码功能：启动相机扫描条形码
- 商品识别：根据条形码查询商品信息
- 营养数据：显示包装食品营养成分表
- 份量调整：输入实际食用份量
- 品牌食品库：1000+常见包装食品数据

**技术实现：**
- 条形码识别：调用条形码识别SDK
- 商品数据库：对接商品信息API（如食品伙伴网）
- 数据补充：用户可补充缺失的商品信息

**界面截图位置：**
> [待补充：条形码扫描界面截图]

---

## 三、营养分析与数据报告

### 3.1 即时营养分析
**功能描述：**
每次记录餐食后，系统立即生成单餐营养分析报告，展示本餐的热量、三大营养素、微量元素等信息。

**主要功能点：**
- 营养总览：展示总热量和宏量营养素（蛋白质、碳水、脂肪）
- 营养素占比：饼图展示三大营养素比例
- 微量元素：钠、纤维、维生素、矿物质等
- 营养评分：根据营养均衡度打分（0-100分）
- 即时建议：根据本餐情况给出改善建议

**技术实现：**
- 营养计算：累加各菜品营养值
- 评分算法：
  - 热量合理性：与单餐目标对比（早餐30%、午餐40%、晚餐30%）
  - 营养平衡性：蛋白质、碳水、脂肪比例合理性
  - 微量元素：钠不超标、纤维充足
  - 综合评分 = 热量得分×0.4 + 平衡性得分×0.4 + 微量元素得分×0.2
- 建议生成：基于规则引擎生成个性化建议

**界面截图位置：**
> [待补充：单餐营养分析界面截图]

---

### 3.2 每日营养报告
**功能描述：**
汇总一天所有餐食记录，生成每日营养总报告，与个人目标对比，分析营养摄入情况。

**主要功能点：**
- 每日汇总：汇总早中晚餐及加餐的营养数据
- 目标对比：
  - 热量摄入 vs 目标热量
  - 蛋白质摄入 vs 目标蛋白质
  - 碳水化合物摄入 vs 目标碳水
  - 脂肪摄入 vs 目标脂肪
  - 钠摄入 vs 推荐上限（2300mg）
  - 纤维摄入 vs 推荐量（25g）
- 进度条展示：可视化显示各营养素完成度
- 超标/不足提醒：标注超标（红色）或不足（黄色）的营养素
- 每日评分：综合评分和星级评价
- 改善建议：针对性的饮食调整建议

**技术实现：**
- 数据聚合：查询当日所有营养记录，按餐次分组汇总
- 对比计算：实际摄入 / 目标值 × 100% = 完成百分比
- 评分算法：
  - 热量达标度：理想范围90%-110%，偏差越大扣分越多
  - 宏量营养素平衡：三者比例接近目标比例得分高
  - 微量元素：钠不超标、纤维达标加分
  - 餐次规律性：三餐都记录且时间合理加分
- 会员权益：
  - 免费用户：基础报告（热量、三大营养素）
  - 会员用户：详细报告（增加微量元素、趋势预测）
  - VIP用户：专业报告（增加深度分析、专家建议）

**界面截图位置：**
> [待补充：每日营养报告界面截图]
> [待补充：营养素对比图表截图]

---

### 3.3 周月趋势分析
**功能描述：**
分析用户一周或一月的饮食数据，展示营养摄入趋势、体重变化趋势、饮食习惯模式。

**主要功能点：**
- 时间范围选择：切换查看周报告或月报告
- 营养趋势曲线：
  - 每日热量摄入曲线
  - 每日蛋白质/碳水/脂肪摄入曲线
  - 每日营养评分曲线
- 体重变化曲线：记录体重的用户可查看体重趋势
- 平均值统计：计算周期内各营养素的日均摄入量
- 饮食规律分析：
  - 记录频次：本周记录了几天
  - 餐次分布：早中晚餐记录占比
  - 饮食时间：各餐平均进食时间
- 饮食模式识别：
  - 高热量日识别：标注摄入超标的日期
  - 低热量日识别：标注摄入不足的日期
  - 营养波动度：分析摄入稳定性
- 目标达成总结：周期内目标达成天数和达成率

**技术实现：**
- 时序数据查询：查询指定时间范围内的所有营养记录
- 统计分析：
  - 日均值 = 总和 / 天数
  - 标准差 = 反映数据波动程度
  - 达标天数 = 在目标范围内的天数
- 数据可视化：使用Recharts绘制趋势图表
- 会员限制：免费用户仅能查看周报告，会员及以上查看月报告

**界面截图位置：**
> [待补充：周趋势分析界面截图]
> [待补充：月趋势分析界面截图]

---

### 3.4 体重管理
**功能描述：**
记录体重变化，结合营养摄入数据，分析体重趋势，预测目标达成时间。

**主要功能点：**
- 体重记录：每日记录当前体重
- 体重曲线：展示体重变化趋势图
- 目标对比：当前体重 vs 目标体重
- 变化速率：本周/本月体重变化幅度
- 预测功能：基于当前趋势预测达成目标所需时间
- BMI计算：显示当前BMI值和健康范围

**技术实现：**
- 体重数据表：记录日期、体重、BMI
- 趋势计算：线性回归预测未来体重
- BMI公式：BMI = 体重(kg) / (身高(m))²
- 健康范围判断：18.5-23.9为正常，<18.5偏瘦，≥24超重

**界面截图位置：**
> [待补充：体重记录界面截图]
> [待补充：体重趋势曲线截图]

---

## 四、智能推荐与配餐

### 4.1 营养缺口分析
**功能描述：**
分析用户当前的营养摄入情况，识别缺少的营养素，给出补充建议。

**主要功能点：**
- 缺口识别：对比当日已摄入与目标值，计算缺口
  - 热量缺口
  - 蛋白质缺口
  - 碳水化合物缺口
  - 脂肪缺口
  - 纤维缺口
- 推荐菜品：推荐能够弥补缺口的菜品
- 推荐食材：推荐富含缺少营养素的食材
- 补充优先级：根据缺口大小排序，优先补充缺口最大的营养素

**技术实现：**
- 缺口计算：目标值 - 已摄入值 = 缺口值
- 菜品匹配算法：
  - 计算各菜品的营养成分
  - 匹配能够补充缺口的菜品
  - 考虑用户偏好和禁忌
  - 按匹配度排序
- 推荐理由生成：解释为什么推荐该菜品

**界面截图位置：**
> [待补充：营养缺口分析界面截图]

---

### 4.2 智能配餐
**功能描述：**
基于用户的健康目标和营养需求，智能生成一日三餐配餐方案，确保营养均衡、热量合理。

**主要功能点：**
- 全天配餐：生成早中晚三餐完整方案
- 单餐配餐：为某一餐生成方案
- 营养平衡：确保三大营养素比例合理
- 热量分配：
  - 早餐：总热量的30%
  - 午餐：总热量的40%
  - 晚餐：总热量的30%
- 菜品搭配：主食、主菜、蔬菜、汤品合理搭配
- 口味考虑：符合用户口味偏好
- 方案多样性：每次生成不同方案，避免重复
- 一键采用：采用方案后自动设为今日计划

**技术实现：**
- 配餐算法：
  1. 计算各餐目标热量和营养素
  2. 从菜品库中筛选候选菜品
  3. 使用背包算法或遗传算法组合菜品
  4. 优化目标：最接近目标营养值，同时考虑菜品多样性
  5. 过滤用户禁忌和不喜欢的食物
- 方案评分：根据营养达标度、菜品多样性、口味适配度综合评分
- 会员限制：免费用户每日1次配餐，会员用户无限次

**界面截图位置：**
> [待补充：智能配餐界面截图]
> [待补充：配餐方案展示截图]

---

### 4.3 菜品推荐
**功能描述：**
基于用户的饮食历史、营养目标、口味偏好，智能推荐适合的菜品。

**主要功能点：**
- 个性化推荐：基于用户画像推荐
- 热门菜品：推荐平台热门菜品
- 季节性推荐：根据当前季节推荐应季菜品
- 新菜品推荐：推荐用户未尝试过的菜品
- 相似推荐：推荐与用户喜欢菜品相似的其他菜品
- 推荐理由：说明推荐原因

**技术实现：**
- 协同过滤算法：基于相似用户的喜好推荐
- 内容推荐算法：基于菜品特征（口味、菜系、营养）推荐
- 混合推荐：结合协同过滤和内容推荐
- 实时更新：根据用户最新行为动态调整推荐

**界面截图位置：**
> [待补充：菜品推荐界面截图]

---

### 4.4 饮水提醒
**功能描述：**
根据用户体重和活动量，计算每日饮水需求，定时提醒用户喝水。

**主要功能点：**
- 饮水目标计算：体重(kg) × 30ml = 每日饮水量
- 饮水记录：用户记录每次饮水量
- 完成度展示：当前饮水量 / 目标量
- 定时提醒：每2小时提醒一次
- 提醒时段设置：自定义提醒时间段

**技术实现：**
- 本地通知：使用系统通知推送提醒
- 饮水记录表：记录日期、时间、饮水量
- 统计分析：展示每日饮水趋势

**界面截图位置：**
> [待补充：饮水提醒界面截图]

---

## 五、社区与社交功能

### 5.1 内容发布
**功能描述：**
用户可以发布晒餐、菜谱、健康经验等内容，与社区用户分享交流。

**主要功能点：**
- 发布类型：
  - 晒餐：分享餐食照片和营养数据
  - 菜谱：分享菜品制作方法
  - 经验：分享健康管理经验
  - 问题：提问寻求帮助
- 内容编辑：
  - 添加图片/视频
  - 编写文字描述
  - 添加标签
  - 关联营养数据
  - 选择可见范围（公开/好友可见）
- 营养数据展示：晒餐时可选择展示营养信息
- 发布审核：内容发布后经过审核

**技术实现：**
- 内容存储：MongoDB存储内容数据
- 图片存储：对象存储服务存储图片和视频
- 审核机制：敏感词过滤 + 人工审核
- 推送通知：通知关注者有新内容

**界面截图位置：**
> [待补充：内容发布界面截图]

---

### 5.2 社交互动
**功能描述：**
用户可以浏览社区内容，进行点赞、评论、收藏、转发等互动操作。

**主要功能点：**
- 内容流展示：
  - 关注动态：关注用户的最新动态
  - 推荐内容：智能推荐感兴趣的内容
  - 热门内容：高互动量的内容
  - 话题广场：按话题分类的内容
- 互动操作：
  - 点赞：为喜欢的内容点赞
  - 评论：发表评论和回复
  - 收藏：收藏优质内容
  - 转发：分享到个人动态
  - 关注：关注感兴趣的用户
- 用户主页：查看其他用户的主页和历史内容
- 私信：用户间私信沟通

**技术实现：**
- 内容推荐算法：基于用户兴趣和行为推荐
- 互动数据统计：实时更新点赞数、评论数
- 消息通知：Redis队列处理通知推送
- 反垃圾机制：限制频繁操作，防止刷量

**界面截图位置：**
> [待补充：社区内容流界面截图]
> [待补充：内容详情和互动界面截图]

---

### 5.3 KOL专家生态
**功能描述：**
邀请营养师、健身教练等专业人士入驻，发布专业内容，提供权威指导。

**主要功能点：**
- 专家认证：营养师、健身教练、医生等专业认证
- 专家主页：展示资质、经验、擅长领域
- 专业内容：发布专业菜谱、营养知识、健康建议
- 问答服务：回答用户提问
- 付费咨询：提供一对一付费咨询服务
- 专家排行：按关注量、互动量、好评度排名

**技术实现：**
- 认证系统：上传资质证书，人工审核认证
- 专家标识：昵称旁显示认证标识
- 内容加权：专家内容在推荐算法中权重更高

**界面截图位置：**
> [待补充：KOL专家列表界面截图]
> [待补充：专家主页界面截图]

---

### 5.4 一键跟吃
**功能描述：**
用户看到KOL分享的健康餐食后，可一键下单购买净菜或成品，送货上门，营养数据自动记录。

**主要功能点：**
- 跟吃入口：KOL内容下方显示"一键跟吃"按钮
- 菜品详情：展示菜品营养信息、制作难度、烹饪时间
- 配送选项：
  - 净菜包：预处理食材 + 调料包 + 菜谱
  - 半成品：部分预制，简单加工即食
  - 成品外卖：即食热食，直接享用
- 份数选择：1人份、2人份、4人份
- 配送时间：选择配送时段
- 下单支付：确认订单并支付
- 订单追踪：查看订单状态和物流信息
- 自动记录：收货后自动添加到营养记录

**技术实现：**
- 供应链对接：对接中央厨房和配送系统
- 订单管理：订单状态流转（待支付-已支付-配货中-配送中-已送达-已完成）
- 支付集成：微信支付、支付宝支付
- 物流追踪：对接物流API实时追踪
- 营养数据同步：根据菜品标准营养数据自动记录

**界面截图位置：**
> [待补充：一键跟吃功能界面截图]
> [待补充：配送选项界面截图]
> [待补充：订单确认界面截图]

---

## 六、游戏化激励系统

### 6.1 等级系统
**功能描述：**
用户通过记录饮食、完成挑战、社区互动等行为获得经验值，经验值累积可提升等级，解锁更多特权。

**主要功能点：**
- 经验值获取：
  - 记录餐食：每次+10经验
  - 连续打卡：连续3天+20经验，7天+50经验
  - 完成挑战：根据难度+50-200经验
  - 社区互动：发布内容+5经验，获得点赞+1经验
  - 达成营养目标：每日目标达成+20经验
- 等级划分：共30个等级
  - Lv1-5：新手营养师
  - Lv6-10：营养助理
  - Lv11-15：营养专家
  - Lv16-20：营养大师
  - Lv21-25：营养宗师
  - Lv26-30：营养传说
- 升级奖励：升级获得虚拟货币、专属称号、个性化头像框
- 等级特权：高等级用户享有优先推荐、专属活动等特权
- 等级展示：个人主页和社区内容显示等级

**技术实现：**
- 经验值计算：各行为对应固定经验值
- 等级公式：升级所需经验 = 100 × 当前等级 × 1.2
- 经验表：预先计算每个等级所需经验值
- 数据库字段：user_gamification_profile表存储等级、当前经验、总经验

**界面截图位置：**
> [待补充：等级系统界面截图]
> [待补充：升级动画效果截图]

---

### 6.2 成就系统
**功能描述：**
设置多种成就任务，用户完成特定条件后解锁成就徽章，收集成就获得荣誉感。

**主要功能点：**
- 成就分类：
  - 记录类：连续记录天数、总记录次数
  - 目标类：连续达标天数、减脂达标
  - 社交类：发布内容数、获得点赞数
  - 探索类：尝试不同菜品、不同菜系
  - 挑战类：完成各类挑战活动
  - 稀有类：特殊条件触发的隐藏成就
- 成就等级：普通、稀有、史诗、传说
- 进度展示：显示成就完成进度
- 解锁动画：成就解锁时播放特效动画
- 成就展示墙：个人主页展示已获得的成就
- 成就奖励：解锁成就获得经验值、虚拟货币、专属称号

**典型成就示例：**
- 初次记录：完成第一次饮食记录
- 坚持不懈：连续记录7天
- 百日营养：连续记录100天
- 营养达人：累计记录500餐
- 平衡大师：连续7天营养均衡
- 社交明星：发布内容获得1000赞
- 美食探险家：尝试50种不同菜品
- 菜系收集者：品尝8大菜系各10道菜

**技术实现：**
- 成就定义表：achievements表存储成就规则
- 用户成就表：user_achievements表记录解锁情况
- 触发检测：用户行为后异步检测成就解锁条件
- 进度更新：实时更新成就完成进度
- 通知推送：成就解锁后推送通知

**界面截图位置：**
> [待补充：成就系统界面截图]
> [待补充：成就解锁动画截图]
> [待补充：成就展示墙截图]

---

### 6.3 连续打卡
**功能描述：**
鼓励用户每日记录饮食，连续打卡天数越多，奖励越丰厚。

**主要功能点：**
- 打卡规则：每日至少记录1餐即算打卡
- 连续天数：统计连续打卡天数
- 最长记录：显示历史最长连续天数
- 里程碑奖励：
  - 连续3天：+20经验
  - 连续7天：+50经验 + 10虚拟货币
  - 连续30天：+200经验 + 50虚拟货币 + 专属称号
  - 连续100天：+1000经验 + 200虚拟货币 + 稀有徽章
- 断签提醒：当日未打卡时推送提醒
- 补签功能：VIP用户可使用补签卡补签

**技术实现：**
- 打卡检测：每日首次记录时标记打卡
- 连续计算：对比当日与昨日的打卡记录，中断则清零
- 最长记录保存：连续天数超过历史记录时更新
- 定时任务：每日23:00检测未打卡用户并提醒

**界面截图位置：**
> [待补充：连续打卡界面截图]

---

### 6.4 挑战活动
**功能描述：**
定期举办各类健康饮食挑战活动，用户参与挑战完成任务，获得奖励和排名。

**主要功能点：**
- 挑战类型：
  - 每日挑战：每日一个简单任务
  - 周挑战：一周内完成特定目标
  - 月挑战：一个月的长期挑战
  - 限时活动：节日或特殊主题活动
- 挑战任务：
  - 营养目标挑战：连续7天达成营养目标
  - 低卡挑战：控制每日热量在1500卡以内
  - 高蛋白挑战：每日蛋白质摄入≥120g
  - 清淡饮食挑战：7天低盐低油饮食
  - 菜品探索挑战：一周尝试7道新菜品
- 挑战排行榜：根据完成度或得分排名
- 挑战奖励：完成挑战获得经验、虚拟货币、实物奖品
- 组队挑战：邀请好友组队完成挑战

**技术实现：**
- 挑战定义表：challenges表存储挑战信息
- 参与记录表：user_challenge_participation表记录用户参与
- 进度跟踪：实时更新挑战完成进度
- 排行榜：Redis有序集合实现实时排行
- 奖励发放：挑战完成后自动发放奖励

**界面截图位置：**
> [待补充：挑战活动界面截图]
> [待补充：挑战详情界面截图]
> [待补充：挑战排行榜截图]

---

### 6.5 美食地图
**功能描述：**
游戏化的美食探索功能，用户通过尝试不同地区、不同菜系的菜品，点亮美食地图，收集成就。

**主要功能点：**
- 地区地图：中国34个省级行政区地图
- 菜系收集：8大菜系（鲁、川、粤、苏、闽、浙、湘、徽）
- 点亮机制：品尝某地区/菜系的菜品即可点亮
- 完成度展示：显示各地区/菜系的探索进度
- 稀有菜品：标注特色菜品，品尝后获得特殊成就
- 地图分享：分享个人美食地图到社区

**技术实现：**
- 地图数据：菜品关联地区和菜系标签
- 探索记录：记录用户品尝过的地区和菜系
- SVG地图：使用SVG绘制中国地图，动态着色
- 完成度计算：已探索 / 总数 × 100%

**界面截图位置：**
> [待补充：美食地图界面截图]

---

## 七、会员体系

### 7.1 会员等级
**功能描述：**
系统实施Freemium商业模式，提供三个会员等级：基础版（免费）、会员版（付费）、VIP版（高级付费），不同等级享有不同权益。

**会员等级对比：**

| 功能权益 | 基础版(免费) | 会员版(¥19.9/月) | VIP版(¥39.9/月) |
|---------|-------------|-----------------|----------------|
| AI识别次数 | 每月10次 | 无限次 | 无限次 |
| 营养记录 | ✅ 基础记录 | ✅ 无限记录 | ✅ 无限记录 |
| 每日报告 | ✅ 基础报告 | ✅ 详细报告 | ✅ 专业报告 |
| 周月趋势 | ❌ 仅周报告 | ✅ 周月报告 | ✅ 高级分析 |
| 智能配餐 | ❌ | ✅ 无限次 | ✅ 无限次 |
| AI菜谱 | ❌ 部分菜谱 | ✅ 全部菜谱 | ✅ 全部菜谱 |
| AI伙伴 | ❌ | ✅ 基础版卡卡 | ✅ 专属皮肤 |
| 广告 | ❌ 有广告 | ✅ 无广告 | ✅ 无广告 |
| 营养师咨询 | ❌ | ❌ | ✅ 每月2次 |
| 专属客服 | ❌ | ❌ | ✅ |
| 微量元素分析 | ❌ | ✅ 基础分析 | ✅ 深度分析 |
| 数据导出 | ❌ | ✅ PDF导出 | ✅ 多格式导出 |
| 会员徽章 | ❌ | ✅ 会员徽章 | ✅ VIP徽章 |

**技术实现：**
- 会员状态管理：membershipStore存储会员信息
- 权限验证：每个功能调用前检查会员权限
- 使用配额：记录免费用户的AI识别使用次数
- 自动续费：支持月付、季付、年付订阅
- 到期提醒：会员到期前3天推送续费提醒

**界面截图位置：**
> [待补充：会员等级对比界面截图]

---

### 7.2 会员中心
**功能描述：**
展示会员权益、使用情况、订阅管理等信息，引导用户升级会员。

**主要功能点：**
- 当前等级展示：显示当前会员等级和到期时间
- 权益说明：列出当前等级享有的权益
- 使用统计：
  - 免费用户：显示已用AI识别次数/总次数
  - 付费用户：显示本月使用各项功能的次数
- 升级对比：展示各等级权益对比，引导升级
- 订阅管理：
  - 查看订阅详情
  - 选择订阅周期
  - 修改订阅计划
  - 取消自动续费
- 优惠活动：展示当前会员优惠活动
- 购买入口：快速购买/升级会员

**技术实现：**
- 会员数据查询：从membershipStore获取会员信息
- 使用统计：查询用户行为记录表统计使用次数
- 订阅管理：对接支付平台的订阅管理API
- 优惠券系统：支持优惠券、折扣码

**界面截图位置：**
> [待补充：会员中心界面截图]
> [待补充：会员升级界面截图]

---

### 7.3 权限管理
**功能描述：**
系统自动根据用户会员等级控制功能权限，免费用户使用高级功能时弹出升级提示。

**主要功能点：**
- 权限拦截：免费用户使用高级功能时拦截
- 升级引导：弹出升级提示框，说明会员权益
- 试用机会：部分功能提供1-2次免费试用
- 智能推荐：根据用户使用习惯推荐合适的会员等级
- 无感升级：升级成功后立即解锁功能，无需重启

**技术实现：**
- 权限检查Hook：useMembershipGuard
- 权限字典：定义各功能所需的会员等级
- 拦截逻辑：功能调用前检查权限，不足时弹出提示
- 升级流程：提示 -> 选择套餐 -> 支付 -> 更新权限 -> 继续使用

**界面截图位置：**
> [待补充：权限拦截提示界面截图]

---

## 八、专业服务

### 8.1 营养师在线咨询
**功能描述：**
用户可预约专业营养师进行一对一咨询，获得个性化的营养指导和健康方案。

**主要功能点：**
- 营养师列表：展示平台认证的营养师
- 营养师信息：
  - 个人照片和简介
  - 教育背景和资质认证
  - 工作经验和擅长领域
  - 用户评价和评分
  - 咨询价格
- 咨询方式：
  - 视频咨询：实时视频通话
  - 语音咨询：实时语音通话
  - 文字咨询：在线聊天
- 预约流程：
  1. 选择营养师
  2. 选择咨询方式和时间
  3. 填写咨询需求
  4. 上传相关资料（饮食记录、体检报告等）
  5. 支付咨询费用
  6. 等待咨询时间
  7. 开始咨询
- 咨询记录：保存咨询历史和营养师建议
- 复诊管理：设置复诊提醒

**技术实现：**
- 营养师数据库：nutritionists表存储营养师信息
- 预约系统：consultation_sessions表管理预约
- 视频通话：集成WebRTC实时音视频通话
- 聊天系统：实时消息推送和存储
- 支付集成：微信支付、支付宝支付
- 会员权益：VIP用户每月赠送2次免费咨询

**界面截图位置：**
> [待补充：营养师列表界面截图]
> [待补充：营养师详情界面截图]
> [待补充：预约咨询界面截图]
> [待补充：在线咨询界面截图]

---

### 8.2 定制营养计划
**功能描述：**
针对特殊人群（孕期、糖尿病、术后康复等）提供专业营养师定制的个性化营养方案。

**主要功能点：**
- 计划分类：
  - 孕期营养方案：针对孕早中晚期的营养方案
  - 糖尿病饮食方案：控糖饮食指导
  - 术后康复方案：促进伤口愈合和身体恢复
  - 高血压饮食方案：低钠饮食指导
  - 痛风饮食方案：低嘌呤饮食指导
  - 运动营养方案：配合训练的营养补充
- 方案内容：
  - 详细的饮食建议
  - 每日配餐方案
  - 营养素补充建议
  - 生活方式指导
  - 注意事项
- 方案周期：7天、14天、30天、90天
- 执行跟踪：
  - 每日打卡
  - 进度监测
  - 营养师在线指导
  - 方案调整优化
- 效果评估：定期评估方案效果

**技术实现：**
- 方案模板库：预设各类人群的营养方案模板
- 个性化定制：营养师根据用户情况调整方案
- 方案存储：用户购买的方案存储在user_nutrition_plans表
- 执行提醒：每日推送方案执行提醒
- 数据追踪：记录用户执行情况

**界面截图位置：**
> [待补充：定制营养计划列表截图]
> [待补充：营养方案详情截图]
> [待补充：方案执行跟踪截图]

---

## 九、商城服务

### 9.1 净菜配送
**功能描述：**
提供新鲜食材和净菜配送服务，用户可购买菜谱对应的食材，送货上门，扫码即可记录营养。

**主要功能点：**
- 商品类型：
  - 净菜套餐：按菜谱配好的食材包
  - 单品食材：购买单一食材
  - 预处理食材：洗净切好的食材
- 商品信息：
  - 食材照片
  - 重量/份数
  - 营养成分
  - 价格
  - 保质期
  - 配送时间
- 购物流程：
  1. 浏览商品或从菜谱购买
  2. 加入购物车
  3. 选择配送地址和时间
  4. 确认订单
  5. 支付
  6. 配送追踪
  7. 收货确认
  8. 评价
- 营养数据关联：每个商品关联精确的营养数据，收货后扫码自动记录
- 订阅服务：支持周期性订阅配送

**技术实现：**
- 商品管理系统：商品库存、价格、描述
- 购物车：Redis存储购物车数据
- 订单系统：order表管理订单状态
- 支付集成：微信支付、支付宝支付
- 配送管理：对接物流系统
- 二维码：每个商品附带二维码，扫码记录营养

**界面截图位置：**
> [待补充：净菜商城界面截图]
> [待补充：商品详情界面截图]
> [待补充：购物车界面截图]
> [待补充：订单管理界面截图]

---

### 9.2 健康食品
**功能描述：**
销售健康食品、营养补充剂、有机食品等，满足用户的健康需求。

**主要功能点：**
- 商品分类：
  - 营养补充剂：蛋白粉、维生素、矿物质等
  - 有机食品：有机蔬菜、有机水果、有机粮油
  - 健康零食：坚果、全麦饼干、代餐棒
  - 特殊食品：无糖食品、低脂食品、高蛋白食品
- 商品筛选：按品类、品牌、价格、评分筛选
- 营养标签：展示商品详细营养成分表
- 用户评价：查看其他用户的购买评价
- 推荐搭配：根据用户营养缺口推荐商品

**技术实现：**
- 商品数据库：存储商品信息和库存
- 推荐算法：基于用户营养缺口推荐商品
- 评价系统：用户购买后可评价商品

**界面截图位置：**
> [待补充：健康食品商城界面截图]

---

### 9.3 营养计划购买
**功能描述：**
用户可购买预设的营养计划，包含配餐方案和食材配送，一站式解决饮食问题。

**主要功能点：**
- 计划分类：按目标分类（减脂、增肌、健康）
- 计划周期：7天、14天、30天
- 计划内容：
  - 每日三餐配餐方案
  - 对应食材配送
  - 烹饪指导
  - 营养师在线支持
- 价格优惠：套餐价格比单独购买更优惠
- 个性化调整：购买后可根据口味调整部分菜品

**技术实现：**
- 计划模板：预设多套营养计划
- 订单生成：购买后自动生成每日配餐和配送订单
- 自动执行：按计划日期自动推送配餐和配送

**界面截图位置：**
> [待补充：营养计划商城截图]

---

## 十、系统设置

### 10.1 个人信息设置
**功能描述：**
用户可修改个人信息、头像、昵称等。

**主要功能点：**
- 基础信息：昵称、头像、性别、生日
- 健康档案：随时更新身高、体重、活动水平、健康目标
- 账号安全：修改密码、绑定手机/邮箱、设备管理
- 隐私设置：设置个人信息可见范围

**界面截图位置：**
> [待补充：个人信息设置界面截图]

---

### 10.2 通知设置
**功能描述：**
管理各类通知的开关和时间。

**主要功能点：**
- 餐时提醒：设置早中晚餐提醒时间
- 饮水提醒：设置饮水提醒间隔和时段
- 营养报告：每日报告推送时间
- 社区通知：点赞、评论、关注通知
- 活动通知：挑战活动、优惠活动通知

**界面截图位置：**
> [待补充：通知设置界面截图]

---

### 10.3 偏好设置
**功能描述：**
设置个人饮食偏好和系统使用偏好。

**主要功能点：**
- 饮食偏好：
  - 饮食类型：普通、素食、纯素、生酮
  - 过敏食物：勾选过敏的食物
  - 不喜欢的食物：系统推荐时会避开
  - 口味偏好：清淡、适中、重口味
- 系统偏好：
  - 语言：中文、英文
  - 单位：公制、英制
  - 主题：浅色、深色、自动
  - 数据同步：WiFi自动同步、移动网络同步

**界面截图位置：**
> [待补充：偏好设置界面截图]

---

### 10.4 数据管理
**功能描述：**
管理用户数据，支持数据导出、备份、删除。

**主要功能点：**
- 数据导出：导出营养记录、体重记录、报告为Excel/PDF
- 数据备份：备份到云端
- 数据清除：清除指定时间段的记录
- 账号注销：申请删除账号和所有数据

**界面截图位置：**
> [待补充：数据管理界面截图]

---

## 十一、技术特性

### 11.1 离线支持
**功能描述：**
支持离线记录饮食，网络恢复后自动同步。

**技术实现：**
- 本地存储：IndexedDB存储离线数据
- 同步队列：记录离线时的操作，联网后依次执行
- 冲突处理：服务器时间戳为准，解决同步冲突

---

### 11.2 多端同步
**功能描述：**
支持移动端、Web端、小程序数据实时同步。

**技术实现：**
- WebSocket：实时推送数据变更
- 增量同步：只同步变更的数据，节省流量
- 版本控制：记录数据版本，避免同步错误

---

### 11.3 数据安全
**功能描述：**
保障用户数据的安全和隐私。

**技术实现：**
- 数据加密：敏感数据加密存储和传输（AES-256）
- HTTPS：全站HTTPS加密通信
- 访问控制：JWT Token认证，权限验证
- 数据备份：每日全量备份，实时增量备份
- 隐私保护：符合GDPR和国内隐私保护法规

---

### 11.4 性能优化
**功能描述：**
优化系统性能，提供流畅的用户体验。

**技术实现：**
- 图片优化：图片压缩、懒加载、WebP格式
- 缓存策略：Redis缓存热点数据
- CDN加速：静态资源CDN分发
- 代码分割：按路由分割代码，减少首屏加载时间
- 预加载：预加载常用数据和组件

---

*文档版本：v1.0*  
*编制日期：2025年10月2日*  
*编制单位：福宝智能营养健康管理系统项目组*  

**注：本文档中所有标注"待补充"的截图位置，将在实际软著申请时插入相应的系统功能界面截图。**

